let siteConfig = null;function sanitizeText(text){if (typeof text !== 'string') return '';const div = document.createElement('div');div.textContent = text;return div.innerHTML;}function isValidEmail(email){const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;return emailRegex.test(email) && email.length <= 254;}function isValidPhone(phone){const phoneRegex = /^[\d\s\-\(\)\+]{7,20}$/;return phoneRegex.test(phone);}async function loadSiteConfig(){try{const response = await fetch('data/site-config.json');if (!response.ok) throw new Error('Failed to fetch config');siteConfig = await response.json();populateContactInfo();}catch (error){console.warn('Could not load site-config.json, using fallback values:', error);}}function populateContactInfo(){if (!siteConfig) return;const{contact, resume, profile}= siteConfig;const sanitizedEmail = isValidEmail(contact.email) ? contact.email : '';const sanitizedPhone = isValidPhone(contact.phone) ? contact.phone : '';const sanitizedPhoneDisplay = sanitizeText(contact.phoneDisplay);const sanitizedLocation = sanitizeText(contact.location);document.querySelectorAll('[data-contact="email"]').forEach(el =>{if (el.tagName === 'A' && sanitizedEmail){el.href = `mailto:${sanitizedEmail}`;el.textContent = sanitizedEmail;}});document.querySelectorAll('[data-contact="phone"]').forEach(el =>{if (el.tagName === 'A' && sanitizedPhone){el.href = `tel:${sanitizedPhone}`;el.textContent = sanitizedPhoneDisplay;}});document.querySelectorAll('[data-contact="location"]').forEach(el =>{el.textContent = sanitizedLocation;});document.querySelectorAll('[data-resume="download"]').forEach(el =>{if (el.tagName === 'A' && resume.path){const safePath = resume.path.replace(/\.\.\//g, '').replace(/^\//, '');el.href = safePath;}});const jsonLdScript = document.querySelector('script[type="application/ld+json"]');if (jsonLdScript && sanitizedEmail && sanitizedPhone){try{const structuredData = JSON.parse(jsonLdScript.textContent);structuredData.email = sanitizedEmail;structuredData.telephone = sanitizedPhone;structuredData.address ={"@type": "PostalAddress", "addressLocality": sanitizeText(contact.locationShort), "postalCode": sanitizeText(contact.postalCode), "addressRegion": sanitizeText(contact.region), "addressCountry": "IN"};jsonLdScript.textContent = JSON.stringify(structuredData, null, 2);}catch (e){console.warn('Could not update JSON-LD:', e);}}}loadSiteConfig();const container = document.getElementById('three-container');if (container && typeof THREE !== 'undefined'){const scene = new THREE.Scene();const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);const renderer = new THREE.WebGLRenderer({alpha: true, antialias: true});renderer.setSize(window.innerWidth, window.innerHeight);renderer.setClearColor(0xffffff, 0);container.appendChild(renderer.domElement);camera.position.z = 15;const objects = [];const geometries = [ new THREE.BoxGeometry(1, 1, 1), new THREE.BoxGeometry(1.5, 0.5, 1.5), new THREE.OctahedronGeometry(0.8), new THREE.TetrahedronGeometry(0.9), new THREE.IcosahedronGeometry(0.7), new THREE.DodecahedronGeometry(0.6), new THREE.TorusGeometry(0.6, 0.2, 8, 12), new THREE.ConeGeometry(0.7, 1.2, 6), ];for (let i = 0;i < 25;i++){const geometry = geometries[Math.floor(Math.random() * geometries.length)];const colorChoice = Math.random();let color, opacity;if (colorChoice < 0.65){color = 0x1e3a5f;opacity = 0.12 + Math.random() * 0.08;}else{color = 0xc8a882;opacity = 0.1 + Math.random() * 0.08;}const material = new THREE.MeshBasicMaterial({color: color, wireframe: true, transparent: true, opacity: opacity});const mesh = new THREE.Mesh(geometry, material);mesh.position.x = (Math.random() - 0.5) * 40;mesh.position.y = (Math.random() - 0.5) * 50;mesh.position.z = (Math.random() - 0.5) * 25;mesh.rotation.x = Math.random() * Math.PI;mesh.rotation.y = Math.random() * Math.PI;const scale = 0.5 + Math.random() * 1.5;mesh.scale.set(scale, scale, scale);mesh.userData.initialY = mesh.position.y;mesh.userData.scrollSpeed = 0.3 + Math.random() * 1.2;mesh.userData.rotationSpeed ={x: (Math.random() - 0.5) * 0.008, y: (Math.random() - 0.5) * 0.008, z: (Math.random() - 0.5) * 0.008};scene.add(mesh);objects.push(mesh);}let scrollY = 0;window.addEventListener('scroll', () =>{scrollY = window.pageYOffset;});function animate(){requestAnimationFrame(animate);objects.forEach((obj, index) =>{obj.rotation.x += obj.userData.rotationSpeed.x;obj.rotation.y += obj.userData.rotationSpeed.y;obj.rotation.z += obj.userData.rotationSpeed.z;const scrollProgress = scrollY / (document.documentElement.scrollHeight - window.innerHeight);obj.position.y = obj.userData.initialY - (scrollProgress * 60 * obj.userData.scrollSpeed);if (obj.position.y < -30){obj.position.y = 30 + Math.random() * 20;}});renderer.render(scene, camera);}animate();window.addEventListener('resize', () =>{camera.aspect = window.innerWidth / window.innerHeight;camera.updateProjectionMatrix();renderer.setSize(window.innerWidth, window.innerHeight);});}const feathersCanvas = document.getElementById('feathers-canvas');if (feathersCanvas && typeof THREE !== 'undefined'){const feathersScene = new THREE.Scene();const feathersCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);const feathersRenderer = new THREE.WebGLRenderer({canvas: feathersCanvas, alpha: true, antialias: true});feathersRenderer.setSize(window.innerWidth, window.innerHeight);feathersRenderer.setClearColor(0xffffff, 0);feathersCamera.position.z = 10;const feathers = [];const featherCount = 15;function createFeatherGeometry(){const shape = new THREE.Shape();shape.moveTo(0, 0);shape.lineTo(0, 4);const barbCount = 20;for (let i = 0;i <= barbCount;i++){const t = i / barbCount;const y = t * 4;const width = Math.sin(t * Math.PI) * 0.8;if (i === 0){shape.moveTo(0, 0);}shape.lineTo(width, y);}for (let i = barbCount;i >= 0;i--){const t = i / barbCount;const y = t * 4;const width = Math.sin(t * Math.PI) * 0.8;shape.lineTo(-width, y);}shape.lineTo(0, 0);const extrudeSettings ={depth: 0.05, bevelEnabled: true, bevelThickness: 0.02, bevelSize: 0.02, bevelSegments: 2};const geometry = new THREE.ExtrudeGeometry(shape, extrudeSettings);return geometry;}for (let i = 0;i < featherCount;i++){const geometry = createFeatherGeometry();const colorChoice = Math.random();let color, opacity;if (colorChoice < 0.3){color = 0x2a4a6f;opacity = 0.12 + Math.random() * 0.08;}else if (colorChoice < 0.55){color = 0xc8a882;opacity = 0.15 + Math.random() * 0.1;}else if (colorChoice < 0.75){color = 0x6b9b9e;opacity = 0.13 + Math.random() * 0.08;}else if (colorChoice < 0.90){color = 0xc99b8a;opacity = 0.14 + Math.random() * 0.09;}else{color = 0x8b9e8c;opacity = 0.12 + Math.random() * 0.08;}const material = new THREE.MeshBasicMaterial({color: color, transparent: true, opacity: opacity, side: THREE.DoubleSide});const feather = new THREE.Mesh(geometry, material);const segmentWidth = 40;const numSegments = featherCount;const segmentSize = segmentWidth / numSegments;const baseX = -20 + (i * segmentSize) + (segmentSize / 2);const randomOffset = (Math.random() - 0.5) * (segmentSize * 0.6);feather.position.x = baseX + randomOffset;feather.position.y = Math.random() * 20 - 5;feather.position.z = -8 + Math.random() * 6;feather.rotation.z = (Math.random() - 0.5) * Math.PI * 0.6;feather.rotation.x = (Math.random() - 0.5) * 0.4;feather.rotation.y = (Math.random() - 0.5) * 0.3;const scale = 0.6 + Math.random() * 0.6;feather.scale.set(scale, scale, scale);feather.userData ={speedY: 0.008 + Math.random() * 0.015, speedRotation: (Math.random() - 0.5) * 0.008, amplitude: 0.6 + Math.random() * 0.8, frequency: 0.0008 + Math.random() * 0.0015, swayOffset: Math.random() * Math.PI * 2, initialX: feather.position.x};feathers.push(feather);feathersScene.add(feather);}function animateFeathers(){requestAnimationFrame(animateFeathers);feathers.forEach((feather, index) =>{const time = Date.now() * feather.userData.frequency + feather.userData.swayOffset;feather.position.y -= feather.userData.speedY;feather.position.x = feather.userData.initialX + Math.sin(time) * feather.userData.amplitude;feather.rotation.z += feather.userData.speedRotation;feather.rotation.y = Math.sin(time * 0.8) * 0.2;feather.rotation.x = Math.cos(time * 0.6) * 0.15;if (feather.position.y < -12){feather.position.y = 12 + Math.random() * 5;const segmentWidth = 40;const numSegments = featherCount;const segmentSize = segmentWidth / numSegments;const baseX = -20 + (index * segmentSize) + (segmentSize / 2);const randomOffset = (Math.random() - 0.5) * (segmentSize * 0.6);feather.userData.initialX = baseX + randomOffset;feather.position.x = feather.userData.initialX;}});feathersRenderer.render(feathersScene, feathersCamera);}animateFeathers();window.addEventListener('resize', () =>{feathersCamera.aspect = window.innerWidth / window.innerHeight;feathersCamera.updateProjectionMatrix();feathersRenderer.setSize(window.innerWidth, window.innerHeight);});window.addEventListener('scroll', () =>{const contactSection = document.getElementById('contact');if (contactSection){const rect = contactSection.getBoundingClientRect();const isVisible = rect.top < window.innerHeight && rect.bottom > 0;feathersCanvas.style.opacity = isVisible ? '1' : '0';}});}const shapesCanvas = document.getElementById('shapes-canvas');if (shapesCanvas && typeof THREE !== 'undefined'){const shapesScene = new THREE.Scene();const shapesCamera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);const shapesRenderer = new THREE.WebGLRenderer({canvas: shapesCanvas, alpha: true, antialias: true});shapesRenderer.setSize(window.innerWidth, window.innerHeight);shapesRenderer.setClearColor(0xffffff, 0);shapesCamera.position.z = 12;const geometricShapes = [];const shapeCount = 25;const shapeGeometries = [ new THREE.PlaneGeometry(2.5, 2.5), new THREE.CircleGeometry(1.4, 6), new THREE.CircleGeometry(1.5, 3), new THREE.CircleGeometry(1.2, 5), new THREE.PlaneGeometry(3, 0.8), new THREE.PlaneGeometry(1.8, 1.8), new THREE.CircleGeometry(1.3, 8), ];for (let i = 0;i < shapeCount;i++){const geometry = shapeGeometries[Math.floor(Math.random() * shapeGeometries.length)];const edges = new THREE.EdgesGeometry(geometry);const colorChoice = Math.random();let color, opacity;if (colorChoice < 0.6){color = 0x2a4a6f;opacity = 0.15 + Math.random() * 0.1;}else{color = 0xc8a882;opacity = 0.12 + Math.random() * 0.08;}const material = new THREE.LineBasicMaterial({color: color, transparent: true, opacity: opacity, linewidth: 2});const shape = new THREE.LineSegments(edges, material);const totalWidth = 50;const segmentSize = totalWidth / shapeCount;const baseX = -(totalWidth / 2) + (i * segmentSize) + (segmentSize / 2);const randomOffset = (Math.random() - 0.5) * (segmentSize * 0.4);shape.position.x = baseX + randomOffset;shape.position.y = Math.random() * 30 - 5;shape.position.z = -10 + Math.random() * 8;shape.rotation.z = Math.random() * Math.PI * 2;shape.rotation.x = (Math.random() - 0.5) * 0.5;const scale = 0.8 + Math.random() * 0.8;shape.scale.set(scale, scale, scale);shape.userData ={speedY: 0.015 + Math.random() * 0.025, speedRotation: (Math.random() - 0.5) * 0.015, rotationAxis: Math.random() < 0.5 ? 'z' : 'x', amplitude: 0.5 + Math.random() * 0.7, frequency: 0.0008 + Math.random() * 0.0012, swayOffset: Math.random() * Math.PI * 2, initialX: shape.position.x};geometricShapes.push(shape);shapesScene.add(shape);}function animateShapes(){requestAnimationFrame(animateShapes);geometricShapes.forEach((shape, index) =>{const time = Date.now() * shape.userData.frequency + shape.userData.swayOffset;shape.position.y -= shape.userData.speedY;shape.position.x = shape.userData.initialX + Math.sin(time) * shape.userData.amplitude;if (shape.userData.rotationAxis === 'z'){shape.rotation.z += shape.userData.speedRotation;}else{shape.rotation.x += shape.userData.speedRotation;}if (shape.position.y < -18){shape.position.y = 18 + Math.random() * 8;const totalWidth = 50;const segmentSize = totalWidth / shapeCount;const baseX = -(totalWidth / 2) + (index * segmentSize) + (segmentSize / 2);const randomOffset = (Math.random() - 0.5) * (segmentSize * 0.4);shape.userData.initialX = baseX + randomOffset;shape.position.x = shape.userData.initialX;}});shapesRenderer.render(shapesScene, shapesCamera);}animateShapes();window.addEventListener('resize', () =>{shapesCamera.aspect = window.innerWidth / window.innerHeight;shapesCamera.updateProjectionMatrix();shapesRenderer.setSize(window.innerWidth, window.innerHeight);});window.addEventListener('scroll', () =>{const bentoSection = document.getElementById('bento');if (bentoSection){const rect = bentoSection.getBoundingClientRect();const isVisible = rect.top < window.innerHeight && rect.bottom > 0;shapesCanvas.style.opacity = isVisible ? '1' : '0';}});}const navToggle = document.getElementById('nav-toggle');const mobileMenu = document.getElementById('mobile-menu');const menuOverlay = document.getElementById('menu-overlay');const closeMenu = document.getElementById('close-menu');const hamburger = document.querySelector('.hamburger');const mobileLinks = document.querySelectorAll('#mobile-menu a');function openMenu(){mobileMenu.classList.add('active');menuOverlay.classList.add('active');hamburger.classList.add('active');document.body.style.overflow = 'hidden';}function closeMenuFunc(){mobileMenu.classList.remove('active');menuOverlay.classList.remove('active');hamburger.classList.remove('active');document.body.style.overflow = '';}navToggle?.addEventListener('click', openMenu);closeMenu?.addEventListener('click', closeMenuFunc);menuOverlay?.addEventListener('click', closeMenuFunc);mobileLinks.forEach(link =>{link.addEventListener('click', closeMenuFunc);});const io = new IntersectionObserver((entries) =>{entries.forEach(e =>{if (e.isIntersecting){e.target.classList.add('in-view');}});},{threshold: 0.1, rootMargin: '0px 0px -50px 0px'});document.querySelectorAll('.fade-up').forEach(el => io.observe(el));const scrollProgress = document.querySelector('.scroll-progress');window.addEventListener('scroll', () =>{const windowHeight = document.documentElement.scrollHeight - document.documentElement.clientHeight;const scrolled = (window.scrollY / windowHeight) * 100;if (scrollProgress){scrollProgress.style.width = scrolled + '%';}});const backToTop = document.getElementById('back-to-top');window.addEventListener('scroll', () =>{if (window.scrollY > 500){backToTop?.classList.add('show');}else{backToTop?.classList.remove('show');}});backToTop?.addEventListener('click', () =>{window.scrollTo({top: 0, behavior: 'smooth'});});document.getElementById('contact-form')?.addEventListener('submit', async function(e){e.preventDefault();const form = e.currentTarget;const submitButton = form.querySelector('button[type="submit"]');const buttonText = submitButton.querySelector('span');const feedbackElement = document.getElementById('form-feedback');const name = form.name.value.trim();const email = form.email.value.trim();const message = form.message.value.trim();feedbackElement.textContent = '';feedbackElement.className = 'text-sm font-medium';if (!name || !email || !message){feedbackElement.textContent = 'Please fill in all fields.';feedbackElement.className = 'text-sm font-medium text-red-600';return;}const nameRegex = /^[a-zA-Z\s\-]{2,100}$/;if (!nameRegex.test(name)){feedbackElement.textContent = 'Please enter a valid name (letters, spaces, and hyphens only).';feedbackElement.className = 'text-sm font-medium text-red-600';return;}if (!isValidEmail(email)){feedbackElement.textContent = 'Please enter a valid email address.';feedbackElement.className = 'text-sm font-medium text-red-600';return;}if (message.length < 10 || message.length > 5000){feedbackElement.textContent = 'Message must be between 10 and 5000 characters.';feedbackElement.className = 'text-sm font-medium text-red-600';return;}const sanitizedName = sanitizeText(name);const sanitizedEmail = sanitizeText(email);const sanitizedMessage = sanitizeText(message);submitButton.disabled = true;submitButton.style.opacity = '0.6';submitButton.style.cursor = 'not-allowed';const originalButtonHTML = buttonText.innerHTML;buttonText.innerHTML = '<i class="bi bi-hourglass-split animate-spin"></i> Sending...';try{const formData = new FormData();formData.append('name', sanitizedName);formData.append('email', sanitizedEmail);formData.append('message', sanitizedMessage);formData.append('_captcha', 'false');formData.append('_subject', `Website inquiry from ${sanitizedName}`);const response = await fetch(form.action,{method: 'POST', body: formData, headers:{'Accept': 'application/json'}});if (response.ok){buttonText.innerHTML = '<i class="bi bi-check-circle-fill"></i> Thank You!';submitButton.style.backgroundColor = 'var(--accent)';submitButton.style.borderColor = 'var(--accent)';submitButton.style.opacity = '1';feedbackElement.textContent = 'Your message has been sent successfully. I\'ll get back to you soon!';feedbackElement.className = 'text-sm font-medium text-green-600';setTimeout(() =>{form.reset();buttonText.innerHTML = originalButtonHTML;submitButton.style.backgroundColor = 'var(--primary)';submitButton.style.borderColor = 'var(--primary)';submitButton.style.cursor = 'pointer';submitButton.disabled = false;feedbackElement.textContent = '';}, 5000);}else{throw new Error('Form submission failed');}}catch (error){console.error('Form submission error:', error);buttonText.innerHTML = originalButtonHTML;submitButton.style.opacity = '1';submitButton.style.cursor = 'pointer';submitButton.disabled = false;feedbackElement.textContent = 'Something went wrong. Please try again or email me directly.';feedbackElement.className = 'text-sm font-medium text-red-600';}});const lenis = new Lenis({duration: 1.0, easing: (t) => t < 0.5 ? 2 * t * t : 1 - Math.pow(-2 * t + 2, 2) / 2, orientation: 'vertical', gestureOrientation: 'vertical', smoothWheel: true, wheelMultiplier: 0.8, smoothTouch: false, touchMultiplier: 1.5, infinite: false, syncTouch: true,});function raf(time){lenis.raf(time);requestAnimationFrame(raf);}requestAnimationFrame(raf);document.querySelectorAll('a[href^="#"]').forEach(anchor =>{anchor.addEventListener('click', function (e){const href = this.getAttribute('href');if (href !== '#' && href !== '#resume'){e.preventDefault();const target = document.querySelector(href);if (target){const navbarHeight = 140;const targetPosition = target.getBoundingClientRect().top + window.pageYOffset - navbarHeight;lenis.scrollTo(targetPosition,{offset: 0, duration: 1.5, easing: (t) => Math.min(1, 1.001 - Math.pow(2, -10 * t)), onComplete: () =>{if (href === '#contact'){const nameInput = document.getElementById('contact-name');if (nameInput){setTimeout(() =>{nameInput.focus();}, 100);}}}});const mobileMenu = document.getElementById('mobile-menu');const navToggle = document.getElementById('nav-toggle');if (mobileMenu && mobileMenu.classList.contains('active')){mobileMenu.classList.remove('active');navToggle.classList.remove('active');}}}});});if (typeof gsap !== 'undefined'){try{gsap.registerPlugin(ScrollTrigger);gsap.to('#contact-form button[type="submit"]',{scale: 1.015, transformOrigin: 'center center', repeat: -1, yoyo: true, ease: 'sine.inOut', duration: 2.5, repeatDelay: 8});}catch (err){console.warn('GSAP initialization failed:', err);}}